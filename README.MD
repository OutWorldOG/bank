# Банк "Банк"

Restful приложение "Банк" предоставляют API для создания/удаления банковского счёта, банковских карт, стандартных манипуляций с банковскими картами, а также возможность для отслеживания транзакций.


### Фреймворки и библиотеки, использующиеся в проекте

*Java 17 <br>
*Spring Boot <br>
*Spring AOP <br>
*Spring Web <br>
*Spring Security <br>
*Spring Data JPA <br>
*Hibernate Validator <br>
*Lombok <br>
*H2 <br>
*Springfox <br>
*Springdoc <br>

## Запуск проекта

Проект запускается на порте 8080. <br>

```
   mvn spring-boot:run
   ```
## Архитектура проекта

Проект состоит из одного модуля. Модуль имеет стандартную архмитектуру для crud приложения: controller-service-repository.<br>
За обработку ошибок отвечает ControllerAdvice, за логгирование - Aspect. <br>
При запуске проекта отрабатывает schema.sql скрипт, который наполняет h2 3 таблицами: bank_user, user_account, transaction_history 
(в таком же порядке упоминание настроена связь между таблицами + каскадность: удалив bank_user - удалятся все строки из user_account, связанные с удаляемой строкой
bank_user. А в transaction_history удалятся все строки, связанные с удаляемой строкой из user_account)

Все логи сохраняются в файл myLoggs.

Также у проект есть тесты, нацеленные на сервисный уровень приложения, прогоняющие положительные/отрицательные сценарии.

h2 бд по адресу - http://localhost:8080/h2


## API

с API можно ознакомиться после поднятия проекта по адресу - http://localhost:8080/swagger-ui/index.html#/

user-bank-controller - отвечает за все манипуляции, связанные с банковским аккаунтом юзера

user-card-controller - все манипуляции, связанные с картой

Для начала работы необходимо создать аккаунт и получить номер карты через post запрос /api/v1/bank/account (см. подробнее в swagger)

Чтобы получить ещё одну карту - проделать ещё раз описанное выше.

Имея номер карты и пин можно /withdraw, /deposit, /transfer, а также получить всю инфу по транзакциям, связанным с картой - /transactions.
Также карте можно удалить через DELETE запрос /card.

При отрицательном сценарии приходит соответствующих код ошибки (400 или 404) с небольшим поясняющим текстом в теле.

### API Restrictions

На все запросы идут стандартные ограничения: все поля обязательны, все поля не должны быть пустыми, каждое из полей должно содержать
минимальное (а в некоторых случаях и максимальное) кол-во символом (см. swagger для подробностей)

номер карты - строго 16 символов, только цифры. Пин - строго только 4 цифры.

При /transfer значение amountOfMoney обеих карт должно совпадать, номера карт совпадать не могут.
